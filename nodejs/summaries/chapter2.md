# ì„¹ì…˜2. ë…¸ë“œ ê¸°ë³¸ ê¸°ëŠ¥ ìµíˆê¸°

ì§„í–‰ìƒíƒœ: ì™„ê°•
ê¸°ê°„: July 23, 2023 â†’ July 30, 2023

## REPL ì‚¬ìš©í•˜ê¸°

- R(Read), E(Evaluate), P(Print), L(Loop)
- jsíŒŒì¼ì— ì“°ë©´ ë¨¼ì € ì½ê³ , ì‹¤í–‰í•˜ê³ , ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ê³ , ë°˜ë³µí•œë‹¤.
- console.log() ìì²´ëŠ” undefinedë¥¼ returní•œë‹¤
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-23 á„‹á…©á„’á…® 11.33.18.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-23_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_11.33.18.png)
    

## CommonJS ëª¨ë“ˆ ì‹œìŠ¤í…œ

- ëª¨ë“ˆ : íŠ¹ì •í•œ ê¸°ëŠ¥ì„ í•˜ëŠ” í•¨ìˆ˜ë‚˜ ë³€ìˆ˜ë“¤ì˜ ì§‘í•©
- module.exports ëŠ” íŒŒì¼ì—ì„œ ë‹¨ í•œ ë²ˆë§Œ ì¨ì•¼í•œë‹¤.

```jsx
// var.js
const odd = "í™€ìˆ˜ì…ë‹ˆë‹¤";
const even = "ì§ìˆ˜ì…ë‹ˆë‹¤";

// ê°ì²´ë¡œ ë„˜ê²¨ì£¼ê¸° -> ë³´í†µ í•œ ê°œ ì´ìƒì˜ ê°’ì„ ë„˜ê²¨ì¤„ ë•ŒëŠ” ê°ì²´ë¥¼ í™œìš©í•œë‹¤!
module.exports = {
  odd,
  even,
};

// ë°°ì—´ë¡œ ë„˜ê²¨ì£¼ê¸°
// module.exports = [odd, even];
```

```jsx
// func.js
const { odd, even } = require("./var");

function checkOddOrEven(number) {
  if (number % 2) {
    return odd;
  } else {
    return even;
  }
}

module.exports = checkOddOrEven;
```

```jsx
// index.js
const { odd, even } = require("./var"); // êµ¬ì¡° ë¶„í•´ í• ë‹¹
const checkNumber = require("./func"); // ì›í•˜ëŠ” ë³€ìˆ˜ë¡œ ê°€ì ¸ì˜¤ê¸° ê°€ëŠ¥

function checkStringOddOrEven(str) {
  if (str.length % 2) {
    return odd;
  } else {
    return even;
  }
}

console.log(checkNumber(10));                  // ì§ìˆ˜ì…ë‹ˆë‹¤
console.log(checkStringOddOrEven("hello"));    // í™€ìˆ˜ì…ë‹ˆë‹¤
```

## exports, this, require, ìˆœí™˜ì°¸ì¡°

### exports

- module ìƒëµ ê°€ëŠ¥
    - but, exportsì™€ module.exportsë¥¼ ë™ì‹œì— ì“°ë©´ ë‹¤ì‹œ ë®ì–´ì”Œì›Œì§€ê¸° ë•Œë¬¸ì— ê°™ì´ ì“¸ ìˆ˜ ì—†ë‹¤.
    
    ```jsx
    module.exports === exports === {}    // ë¹ˆ ê°ì²´ì™€ ê°™ë‹¤
    ```
    
    ```jsx
    // var.js
    const odd = "í™€ìˆ˜ì…ë‹ˆë‹¤";
    const even = "ì§ìˆ˜ì…ë‹ˆë‹¤";
    
    exports.odd = odd;
    exports.even = even;
    
    // module.exports = { odd, even };
    
    // ì´ë ‡ê²Œë„ í•  ìˆ˜ëŠ” ìˆì§€ë§Œ ì‚¬ìš© ì•ˆí•¨
    // this.odd = odd;
    // this.even = even;
    ```
    
- ì°¸ì¡° ê´€ê³„ê°€ ëŠê¸°ëŠ” ê²½ìš°
    
    ```jsx
    // module.exports !== exports
    
    // í•¨ìˆ˜ë¥¼ ëŒ€ì…í•  ê²½ìš°
    module.exports = checkOddOrEven;
    
    // ìƒˆë¡œìš´ ê°ì²´ë¥¼ ëŒ€ì…í•  ê²½ìš°
    module.exports = {}
    ```
    

### this

- Nodeì—ì„œ scopeì— ë”°ë¥¸ this
    - ì „ì—­ ìŠ¤ì½”í”„ì˜ `this` â†’ ë¹ˆ ê°ì²´
    - ì§€ì—­ ìŠ¤ì½”í”„ì˜ `this` â†’ global
    
    ```jsx
    console.log(this);                        // {}
    console.log(this === module.exports);     // true
    
    function a() {
      console.log(this === global);           // true
    }
    a();
    ```
    

## require

- í•œ ë²ˆ requireëœ ì •ë³´ëŠ” requireì•ˆì— cacheì— ì €ì¥í•œë‹¤. â†’ ìºì‹±í•œë‹¤ â‡’ ë©”ëª¨ë¦¬ì— ì €ì¥ëœë‹¤.
- ë‹¤ë¥¸ íŒŒì¼ì—ì„œ í•œë²ˆ ë” varë¥¼ ë¶ˆëŸ¬ì˜¬ ê²½ìš° varíŒŒì¼ì„ ì•ˆì½ê³  ìºì‹œ(ë©”ëª¨ë¦¬)ì— ì €ì¥ëœ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ë‹¤.
â‡’ íŒŒì¼ì„ í•œ ë²ˆë§Œ ì½ê³  ë©”ëª¨ë¦¬ì—ì„œ ë¶ˆëŸ¬ì˜¤ê¸° ë•Œë¬¸ì— ì†ë„ê°€ ë¹ ë¥´ë‹¤.
- requireì´ ë‹´ê³ ìˆëŠ” ì •ë³´
    - var.jsê°€ cacheë˜ì–´ìˆëŠ” ê±¸ í™•ì¸í•  ìˆ˜ ìˆìŒ.
    
    ```jsx
    require("./var");
    console.log(require);
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„Œá…¥á†« 9.54.48.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.54.48.png)
    
    - ìºì‹±ì´ë€?
        - í•˜ë“œë””ìŠ¤í¬ì—ì„œ ë©”ëª¨ë¦¬ ë””ìŠ¤í¬ë¡œ ì˜®ê²¨ì˜¤ëŠ” í–‰ìœ„
- but, ë‚´ì¥ë˜ì–´ìˆëŠ” ê°ì²´ë¥¼ ì†ëŒ€ëŠ” ê±´ ìœ„í—˜í•˜ë‹¤.
- Nodeì—ì„œëŠ” íŒŒì¼ì´ ì‹¤í–‰ëœ ìƒíƒœì—ì„œ ì½”ë“œë¥¼ ìˆ˜ì •í•˜ë©´ ê»ë‹¤ê°€ ì¼œì•¼ì§€ ìƒˆë¡œìš´ ì½”ë“œê°€ ì ìš©ë˜ì§€ë§Œ ìºì‹œë¥¼ ì˜ í™œìš©í•˜ë©´ ê»ë‹¤ê°€ í‚¤ì§€ ì•Šì•„ë„ ì‹¤ì‹œê°„ìœ¼ë¡œ ì½”ë“œë¥¼ ì—…ë°ì´íŠ¸í•  ìˆ˜ ìˆë‹¤!  ex) nodemon?
- íŠ¹ì§•
    - ë°˜ë“œì‹œ ì œì¼ ìœ„ì— ì˜¬ í•„ìš” ì—†ë‹¤.
    - require.cacheì— í•œ ë²ˆ requireëœ ëª¨ë“ˆì— ëŒ€í•œ ìºì‹œ ì •ë³´ê°€ ë‹´ê²¨ìˆë‹¤.
    - require.mainì€ ë…¸ë“œ ì‹¤í–‰ ì‹œ ì²« ëª¨ë“ˆì„ ê°€ë¦¬í‚¨ë‹¤.
    - ì˜ˆì‹œ
        
        ```jsx
        console.log("ì‹œì‘");
        
        module.exports = "ì‹ ê¸°í•˜êµ°";
        
        require("./var");
        
        console.log(require.cache);
        console.log(require.main === module);
        console.log(require.main.filename);
        
        // ë²ˆì™¸
        // ì•„ë˜ì™€ ê°™ì´ ë‹¤ë¥¸ ëª¨ë“ˆì˜ exportsë¥¼ êº¼ë‚´ì˜¬ ìˆ˜ ìˆë‹¤! -> but ì§ì ‘ ë‚´ì¥ ê°ì²´ì— ì†ëŒ€ëŠ” ê±´ ìœ„í—˜í•˜ì—¬ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤. ì‹ ê¸°í•˜ë‹ˆê¹Œ í…ŒìŠ¤íŠ¸ë§Œ :)
        console.log(
          require.cache["/Users/chohyein/Documents/study/node/javascript/3ê°•/var.js"]
            .exports.odd
        );
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„Œá…¥á†« 10.03.23.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.03.23.png)
        

### ìˆœí™˜ ì°¸ì¡°

- ìˆœí™˜ ì°¸ì¡° ë°œìƒ
    - dep1ì´ dep2ë¥¼ ì°¸ì¡°í•˜ê³  dep2ë¡œ ê°”ë”ë‹ˆ dep1ì„ ì°¸ì¡°í•˜ê³  ë¬´í•œì ìœ¼ë¡œ ì°¸ì¡°í•œë‹¤
    
    ```jsx
    // dep1.js
    require('./dep2');
    
    // dep2.js
    require('./dep1');
    ```
    
    - ìˆœí™˜ ì°¸ì¡°ê°€ ë°œê²¬ë˜ë©´ NodeëŠ” dep1 ì‹¤í–‰ í›„ dep2ë¡œ ê°”ì„ ë•Œ exportsë¥¼ ë¹ˆ ê°ì²´ë¡œ ë°”ê¿”ë²„ë¦°ë‹¤.
    â‡’ ì°¨ë‹¨í•´ë²„ë¦°ë‹¤.

<aside>
ğŸ’¡ ìµœëŒ€í•œ ìˆœí™˜ì°¸ì¡°ë¥¼ í•˜ì§€ ì•Šë„ë¡ í•˜ì!

</aside>

## ECMA Script ëª¨ë“ˆ, ë‹¤ì´ë‚˜ë¯¹ ì„í¬íŠ¸, top level await

### ECMA Script ëª¨ë“ˆ(import, export default) / top level await

- ECMA Script ëª¨ë“ˆ = ES ëª¨ë“ˆ
- ê³µì‹ì ì¸ Javascript ëª¨ë“ˆ í˜•ì‹
- Nodeë„ commonJS â†’ ESëª¨ë“ˆë¡œ ë„˜ì–´ê°€ëŠ” ì¶”ì„¸

```jsx
// var.mjs
export const odd = 'í™€ìˆ˜ì…ë‹ˆë‹¤.';      // named export
export const even = 'ì§ìˆ˜ì…ë‹ˆë‹¤.';
```

```jsx
import {odd, even} from './var.mjs';
import checkNumber from './func.mjs';

function checkOddOrEven(){
 ...
}

export default checkOddOrEven;      // default export
```

- mjs í™•ì¥ì ëŒ€ì‹  js í™•ì¥ìë¥¼ ì‚¬ìš©í•˜ê³  ESëª¨ë“ˆì„ ì‚¬ìš©í•˜ë ¤ë©´ package.jsonì— type ì†ì„±ì„ ë„£ì–´ì£¼ì–´ì•¼ í•œë‹¤.
    
    ```jsx
    type: "module"
    ```
    
- í™•ì¥ìëŠ” ë°˜ë“œì‹œ ë¶™ì—¬ì£¼ì–´ì•¼í•œë‹¤!
- CommonJSì™€ ECMA Script ëª¨ë“ˆ ì°¨ì´ì 
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„Œá…¥á†« 10.52.45.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.52.45.png)
    
    - ESëª¨ë“ˆì—ì„œëŠ” scriptì—ì„œ ë°”ë¡œ awaitë¥¼ ì¨ë„ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•œë‹¤!
        
        ```jsx
        await a(); 
        ```
        

### ë‹¤ì´ë‚˜ë¯¹ ì„í¬íŠ¸

- CommonJSì—ì„œëŠ” ê°€ëŠ¥í•˜ë‚˜ ESëª¨ë“ˆì—ì„œëŠ” ì‚¬ìš© ë¶ˆê°€
- ESëª¨ë“ˆì—ì„œëŠ” ë°˜ë“œì‹œ import êµ¬ë¬¸ì€ ìµœìƒë‹¨ì— ì„ ì–¸ë˜ì–´ì•¼ í•œë‹¤.
- ex)
    
    ```jsx
    const a = true;
    if(a) {
    	require('./func');       // ê°€ëŠ¥(CommonJS)
      import('./func');        // ë¶ˆê°€ëŠ¥(ESëª¨ë“ˆ)
    }
    ```
    
- ES ëª¨ë“ˆì—ì„œ ë‹¤ì´ë‚´ë¯¹ ì„í¬íŠ¸ê°€ í•„ìš”í•  ê²½ìš° import() í•¨ìˆ˜ë¥¼ í™œìš©í•œë‹¤
    - defaultë¡œ export í•  ê²½ìš° m1, ê°ì²´ì— ì „ë‹¬í•´ì¤¬ì„ ê²½ìš° m2 ì²˜ëŸ¼ ëœë‹¤.
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„Œá…¥á†« 11.46.31.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.46.31.png)
    

## [ë…¸ë“œ ë‚´ì¥ ê°ì²´] global, console, íƒ€ì´ë¨¸

### global

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„Œá…¥á†« 11.53.31.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_11.53.31.png)

- ë¸Œë¼ìš°ì €ì˜ window ê°™ì€ ì—­í• 
- ì‚¬ì‹¤ìƒ require, console, module ë“±ì€ globalì´ ìƒëµëœ í‘œí˜„ì´ë‹¤
    
    ```jsx
    global.require
    global.console.log
    global.module.exports
    ```
    
- global ì†ì„±ì— ê°’ì„ ëŒ€ì…í•˜ë©´ ë‹¤ë¥¸ íŒŒì¼ì—ì„œë„ ì‚¬ìš© ê°€ëŠ¥í•˜ì§€ë§Œ ì–´ë””ì—ì„œ ëŒ€ì…ëëŠ”ì§€ ëª¨ë¥´ë¯€ë¡œ ì™ ë§Œí•˜ë©´ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
    
    ```jsx
    // globalA.js
    module.exports = () => global.message;
    
    // globalB.js
    const A = require('./globalA');
    global.message = 'hello';          // ì ‘ê·¼ ê°€ëŠ¥
    ```
    

### console

- ì¢…ë¥˜
    - console.time, console.timeEnd : ì‹œê°„ ë¡œê¹…
    - console.error : ì—ëŸ¬ ë¡œê¹…
    - console.log : í‰ë²”í•œ ë¡œê·¸
    - console.dir : ê°ì²´ ë¡œê¹…
    - console.trace : í˜¸ì¶œìŠ¤íƒ ë¡œê¹…
    - console.table : í…Œì´ë¸” í˜•íƒœë¡œ ë¡œê¹…

### íƒ€ì´ë¨¸

- ì¢…ë¥˜
    - setTimeout(ì½œë°±í•¨ìˆ˜, ë°€ë¦¬ì´ˆ) : ì£¼ì–´ì§„ ë°€ë¦¬ì´ˆ ì´í›„ì— ì½œë°± í•¨ìˆ˜ ì‹¤í–‰ (ë¹„ë™ê¸° ì½”ë“œ)
    - setInterval(ì½œë°±í•¨ìˆ˜, ë°€ë¦¬ì´ˆ) : ì£¼ì–´ì§„ ë°€ë¦¬ì´ˆë§ˆë‹¤ ì½œë°± í•¨ìˆ˜ë¥¼ ë°˜ë³µ ì‹¤í–‰ (ë¹„ë™ê¸° ì½”ë“œ)
    - setImmediate(ì½œë°±í•¨ìˆ˜) : ì½œë°± í•¨ìˆ˜ë¥¼ ì¦‰ì‹œ ì‹¤í–‰ (ë¹„ë™ê¸° ì½”ë“œ)
    - clearTimeout(ì•„ì´ë””) : setTimeout ì·¨ì†Œ
    - clearInterval(ì•„ì´ë””) : setInterval ì·¨ì†Œ
    - clearImmediate(ì•„ì´ë””) : setImmediate ì·¨ì†Œ
    
    ```jsx
    // ì·¨ì†Œí•˜ê¸° ìœ„í•´ì„œëŠ” ë³€ìˆ˜ì— ì €ì¥í•˜ê³  í•´ë‹¹ ë³€ìˆ˜ë¥¼ ì´ìš©í•´ì„œ ì·¨ì†Œí•œë‹¤.
    const hello = setInterval(() => console.log('hi'), 2000);
    
    clearInterval(hello);
    ```
    
- setImmediateë¥¼ í™œìš©í•˜ì—¬ ì–´ë–¤ ì½”ë“œë“¤ì€ ë™ì‹œì— ë°”ë¡œ ì‹¤í–‰ë˜ë„ë¡ ë°±ê·¸ë¼ìš´ë“œë¡œ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
- setImmediateê°€ ë°”ë¡œ ì¶œë ¥ë˜ì§€ë§Œ ì·¨ì†Œì‹œí‚¬ ìˆ˜ ìˆë‹¤!
â‡’ setImmediateê°€ ì‹¤í–‰ë˜ê¸° ìœ„í•´ `ë°±ê·¸ë¼ìš´ë“œ â†’ íƒœìŠ¤í¬ í â†’ í˜¸ì¶œìŠ¤íƒ(ì´ë²¤íŠ¸ ë£¨í”„)`ìœ¼ë¡œ ê°€ê¸° ë•Œë¬¸ì— í˜¸ì¶œ ìŠ¤íƒê¹Œì§€ ê°€ê¸° ì „ì— clearImmediate() ì‹¤í–‰í•˜ë©´ ì·¨ì†Œí•  ìˆ˜ ìˆë‹¤!
    
    ```jsx
    const immediate = setImmediate(() => console.log('hi'));
    
    clearImmediate(immediate);        // setImmediateì‹¤í–‰ë˜ì§€ ì•Šê³  ì·¨ì†Œë¨
    ```
    

## process

- í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ ë…¸ë“œ í”„ë¡œì„¸ìŠ¤ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆìŒ
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„’á…® 12.13.58.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.13.58.png)
    
- ex)
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„’á…® 12.17.39.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.17.39.png)
    
    - `version` : ë…¸ë“œ ë²„ì „
    - `arch` : í”„ë¡œì„¸ìŠ¤ ì•„í‚¤í…ì²˜ ì •ë³´
    - `platform` : OS í”Œë«í¼ ì •ë³´
    - `pid` : í”„ë¡œì„¸ìŠ¤ id â†’ pidë¥¼ í†µí•´ í”„ë¡œì„¸ìŠ¤ shutdown ê°€ëŠ¥
    - `cwd` : í˜„ì¬ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ëœ ìœ„ì¹˜  â†’ ê²½ë¡œì²´í¬í•  ë•Œ ìì£¼ ì‚¬ìš©ë¨
    - `cpuUsage()` : í˜„ì¬ cpu ì‚¬ìš©ëŸ‰

### process.env(í™˜ê²½ë³€ìˆ˜)

- í™˜ê²½ë³€ìˆ˜ëŠ” process.envë¡œ ì ‘ê·¼
    
    ```jsx
    const secretKey = process.env.SECRET_KEY;
    ```
    
- ì¼ë¶€ í™˜ê²½ë³€ìˆ˜ëŠ” ë…¸ë“œ ì‹¤í–‰ ì‹œ ì˜í–¥ì„ ë¯¸ì¹œë‹¤.
    
    ```jsx
    NODE_OPTIONS=-max-old-space-size=8192    // ë…¸ë“œ ì‹¤í–‰ ì˜µì…˜
    UV_THREADPOOL_SIZE=8                     // ìŠ¤ë ˆë“œí’€ ê°œìˆ˜
    ```
    

### process.nextTick(ì½œë°±í•¨ìˆ˜)

- ì´ë²¤íŠ¸ ë£¨í”„ê°€ ë‹¤ë¥¸ ì½œë°± í•¨ìˆ˜ë“¤ë³´ë‹¤ nextTickì˜ ì½œë°± í•¨ìˆ˜ë¥¼ ìš°ì„ ì ìœ¼ë¡œ ì²˜ë¦¬í•¨
- Promiseì™€ ë§ˆì°¬ê°€ì§€ë¡œ ìš°ì„ ìˆœìœ„ ë†’ìŒ (nextTick > promise > setImmediate or setTimeout)

```jsx
setImmediate(() => console.log("immediate"));

process.nextTick(() => console.log("nextTick"));

setTimeout(() => console.log("timeout"), 0);

Promise.resolve().then(() => console.log("promise"));
```

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-29 á„‹á…©á„’á…® 12.28.28.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-29_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.28.28.png)

### process.exit()

- ì„œë²„ë¥¼ ì¢…ë£Œí•˜ë ¤ê³  í•  ë•Œ ì„œë²„ ë‚´ì—ì„œ process.exit()í•´ì£¼ë©´ ì¢…ë£Œëœë‹¤.
    - `process.exit(0)` â†’ 0ì¼ ê²½ìš° ì—ëŸ¬ ì—†ì´ ì¢…ë£Œí•œë‹¤
    - `process.exit(1)` â†’ 1ì¼ ê²½ìš° ì—ëŸ¬ê°€ ì¡´ì¬í•˜ëŠ” ìƒíƒœë¡œ ì¢…ë£Œí•œë‹¤

## OSì™€ path

### OS

- OS : ë‚´ì¥ ëª¨ë“ˆ
    
    ```jsx
    const os = require('os');
    
    console.log('ë©”ëª¨ë¦¬ ì •ë³´');
    console.log(os.cpus());           // cpu ì½”ì–´ ì •ë³´
    ```
    
    <aside>
    ğŸ’¡ OS ìŠ¤ë ˆë“œì™€ node ìŠ¤ë ˆë“œëŠ” ë‹¤ë¥¸ ìŠ¤ë ˆë“œ! í—·ê°ˆë¦¬ì§€ ë§ê²ƒ!
    
    </aside>
    
    - Node.js docs - [https://nodejs.org/dist/latest-v20.x/docs/api/os.html](https://nodejs.org/dist/latest-v20.x/docs/api/os.html)

### path

```jsx
const path = require('path');

path.join(__dirname, '..', '/var.js');
path.resolve(__dirname, '..', '/var.js');    // resolveëŠ” ì ˆëŒ€ê²½ë¡œë¡œ ê°€ë²„ë¦°ë‹¤

// ê²°ê³¼
// /Users/chohyein/Documents/study/node/javascript/var.js
// /var.js
```

- OSë§ˆë‹¤ ë‹¤ë¥¸ path êµ¬ì„±
    - window â†’ `\javascript\study\test.js`
    - posix(mac or linux) â†’ `/javascript/study/test.js`
- path.join(ê²½ë¡œ, â€¦) : ìƒëŒ€ê²½ë¡œë¡œ ì²˜ë¦¬. ì—¬ëŸ¬ ì¸ìë¥¼ ë„£ì„ ê²½ìš° í•˜ë‚˜ì˜ ê²½ë¡œë¡œ í•©ì³ì¤€ë‹¤.
- path.resolve(ê²½ë¡œ, â€¦) : ì ˆëŒ€ê²½ë¡œë¡œ ì²˜ë¦¬(ìœ„ ì˜ˆì‹œ ë³´ê¸°)
- ìƒëŒ€ê²½ë¡œ / ì ˆëŒ€ê²½ë¡œ
    - ìƒëŒ€ê²½ë¡œ : í˜„ì¬ íŒŒì¼ ê¸°ì¤€. ê°™ì€ ê²½ë¡œë©´ ì  í•˜ë‚˜(.), ìƒìœ„ ê²½ë¡œë©´ ì  ë‘ê°œ(..)
    - ì ˆëŒ€ê²½ë¡œ : root í´ë”ë‚˜ ë…¸ë“œ í”„ë¡œì„¸ìŠ¤ê°€ ì‹¤í–‰ë˜ëŠ” ìœ„ì¹˜ ê¸°ì¤€

## ë…¸ë“œ ë‚´ì¥ ëª¨ë“ˆ(url, dns)ê³¼  searchParams

### url

- ì›ë˜ëŠ” urlì²˜ë¦¬ ì‹œ ë‘ ê°€ì§€ ë°©ì‹(node, WHARWG - ì›¹ í‘œì¤€)ì´ ìˆì—ˆëŠ”ë° ì´ì œëŠ” ì›¹ í‘œì¤€ìœ¼ë¡œ í†µì¼
- WHATWG ì²´ê³„ (ì•„ë˜ ê·¸ë¦¼ ì˜ ê¸°ì–µí•  ê²ƒ!!â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸)
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„Œá…¥á†« 9.24.12.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.24.12.png)
    
    - user, passì— ì•„ì´ë””ì™€ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ëŠ” ê³µê°„ì„ ì§€ì›í•´ì¤€ë‹¤.
    - #hashëŠ” ì„œë²„ëŠ” ì¸ì‹ì„ ëª»í•˜ê³  ë¸Œë¼ìš°ì €ë§Œ ì¸ì‹í•  ìˆ˜ ìˆë‹¤.
    
    ```jsx
    const url = require("url");
    
    const { URL } = url;
    // ê°ì²´ ìƒì„±
    const newUrl = new URL(
      "http://www.gilbut.co.kr/book/booklist.aspx?sercate1=001001000#anchor"
    );
    
    console.log("new URL() : ", newUrl);
    // ê°ì²´ë¥¼ ë‹¤ì‹œ ë¬¸ìì—´ë¡œ ë³€ê²½
    console.log("url.format() : ", url.format(newUrl));
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„Œá…¥á†« 9.32.54.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.32.54.png)
    

### searchParams

- searchParams â†’ search ê°ì²´í™”
- Iterator ê°ì²´ (ë°°ì—´ì²˜ëŸ¼ ë°˜ë³µ ì‘ì—…ì„ ì‰½ê²Œ ë§Œë“¤ì–´ì£¼ëŠ” ê°ì²´)
- appendë¥¼ í†µí•´ 2ë²ˆ ì„¤ì •í•  ê²½ìš° ë°°ì—´ë¡œ ì²˜ë¦¬ëœë‹¤!
    
    ```jsx
    newURL.searchParams.append('filter', 'es3');
    newURL.searchParams.append('filter', 'es5');
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„Œá…¥á†« 9.50.45.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_9.50.45.png)
    

### dns

- ë„ë©”ì¸ì„ ê°€ì§€ê³  ë‹¤ì–‘í•œ ë°©ë²•ìœ¼ë¡œ í™œìš©í•  ìˆ˜ ìˆê²Œ ì—¬ëŸ¬ ì„¤ì •ì„ í•  ìˆ˜ ìˆë‹¤
- ê°ê°ì˜ ì„¤ì • â†’ record
- nodeê°€ íŠ¹ì • ì„œë²„ì˜ ipì£¼ì†Œë¥¼ ì•Œì•„ë‚´ì•¼í•  ë•Œ ì‚¬ìš©
- dns.resolve()ë¥¼ í†µí•´ ì¡°íšŒí•  ìˆ˜ ìˆë‹¤.

```jsx
// domain : gilbut.co.kr

// ipì£¼ì†Œ
const ip = await dns.lookup('gilbut.co.kr');

// ipì£¼ì†Œ
const a = await dns.resolve('gilbut.co.kr', 'A');

// ipì£¼ì†Œ(ipv6)
const aaaa = await dns.resolve('gilbut.co.kr', 'AAAA');

// ë©”ì¼ ì„œë²„
const mx = await dns.resolve('gilbut.co.kr', 'MX');

// wwwë¥¼ ë¶™ì—¬ë„ ë™ì¼í•œ ë„ë©”ì¸ìœ¼ë¡œ ì—°ê²°í•˜ê¸° (ë³„ëª…) 
const cname = await dns.resolve('www.gilbut.co.kr', 'CNAME');
```

- ì½˜ì†”
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„Œá…¥á†« 10.08.26.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.08.26.png)
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„Œá…¥á†« 10.08.54.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%258C%25E1%2585%25A5%25E1%2586%25AB_10.08.54.png)
    

## crypto / util

### crypto(ë‹¨ë°©í–¥ ì•”í˜¸í™”)

- ì•”í˜¸í™” / ë³µí˜¸í™”
    - ì•”í˜¸í™” : í‰ë¬¸ â†’ ì•”í˜¸
    - ë³µí˜¸í™” : ì•”í˜¸ â†’ í‰ë¬¸
- ì•”í˜¸í™”ëŠ” ê°€ëŠ¥í•˜ì§€ë§Œ ë³µí˜¸í™”ëŠ” ë¶ˆê°€
- Hash ê¸°ë²•
    - í‰ë¬¸ì„ ì•”í˜¸ì™€ ê°™ì´ ë§Œë“¤ì§€ë§Œ ë‹¤ì‹œ í‰ë¬¸ìœ¼ë¡œ ë˜ëŒë¦´ ìˆ˜ ì—†ë‹¤.
    - ëŒ€ì‹  í‰ë¬¸ì„ hashí™” í•˜ë©´ í•­ìƒ ë™ì¼í•œ ì•”í˜¸ ê°’ì´ ìƒì„±ë˜ì–´ ë¹„ë°€ë²ˆí˜¸ ê°™ì€ ê°’ë“¤ì— í™œìš©í•  ìˆ˜ ìˆë‹¤.

```jsx
const crypto = require('crypto');

// createHash(ì•Œê³ ë¦¬ì¦˜) : ì‚¬ìš©í•  í•´ì‹œ ì•Œê³ ë¦¬ì¦˜
// update(ë¬¸ìì—´) : ë³€í™˜í•  ë¬¸ìì—´
// digest(ì¸ì½”ë”©) : ì¸ì½”ë”©í•  ì•Œê³ ë¦¬ì¦˜
crypto.createHash('sha512').update('password').digest('base64')
```

- ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜
    - pbkdf2, bcrypt, scrypt ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ ì•”í˜¸í™” ê°€ëŠ¥
    - nodeì—ì„œëŠ” bcryptë¥¼ ì§€ì›í•´ì£¼ì§€ ì•Šê¸° ë•Œë¬¸ì— pbkdf2ë¥¼ í™œìš©í•´ì•¼í•œë‹¤.
    - pbkdf2ëŠ” saltì™€ ì•”í˜¸í™”ëœ hash ê°’ì„ ëª¨ë‘ ì €ì¥í•´ë‘ì–´ì•¼í•œë‹¤.

### crypto(ì–‘ë°©í–¥ ì•”í˜¸í™”)

- ì•”í˜¸í™”, ë³µí˜¸í™” ëª¨ë‘ ê°€ëŠ¥
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 12.52.26.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_12.52.26.png)
    
- ëŒ€ì¹­í˜• ì•”í˜¸í™” : ì•”í˜¸í™” ë° ë³µí˜¸í™” ë•Œ ê°™ì€ keyë¥¼ ì‚¬ìš©í•´ì•¼ í•¨
- keyë¥¼ í›”ì³ê°ˆ ìˆ˜ ìˆê¸° ë•Œë¬¸ì— key ê´€ë¦¬ë¥¼ ì˜ í•´ì•¼í•œë‹¤.
- í”„ë¡ íŠ¸ì˜ ì½”ë“œëŠ” ëª¨ë‘ ê³µê°œë˜ì–´ìˆê¸° ë•Œë¬¸ì— í”„ë¡ íŠ¸-ì„œë²„ ê´€ê³„ì—ì„œëŠ” ê°™ì€ keyë¥¼ ì‚¬ìš©í•˜ë©´ ì•ˆë€ë‹¤!
â‡’ ëŒ€ì¹­í˜• ì•”í˜¸í™” ì‚¬ìš© ë¶ˆê°€
- ë¹„ë°€ë²ˆí˜¸ ê´€ë¦¬ ì „ëµ
    - AWS Key Management Service(KMS)

### util

- ê°ì¢… í¸ì˜ ê¸°ëŠ¥ì„ ëª¨ì•„ë‘” ëª¨ë“ˆ
    - deprecated
        - util.deprecated()ë¡œ í•¨ìˆ˜ë¥¼ ê°ì‹¸ì¤€ë‹¤
        - í•´ë‹¹ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ë•Œë§ˆë‹¤ ì‘ì„±ëœ ê²½ê³ ê°€ ì¶œë ¥ëœë‹¤.
        
        ```jsx
        const util = require('util');
        
        const dontUseMe = util.deprecated((x, y) => {
        	console.log(x + y);
        }, 'deprecatedëœ í•¨ìˆ˜ì…ë‹ˆë‹¤.')
        ```
        
    - promisify
        - callbackí•¨ìˆ˜ì—ì„œ promiseë¡œ ë³€í™”í•˜ê³  ìˆëŠ” ì¶”ì„¸ì¸ë°, callbackì„ ì—†ì• ë©´ ì§€ê¸ˆ ì‚¬ìš©í•˜ê³  ìˆëŠ” ì½”ë“œë“¤ì—ì„œ ë¬¸ì œê°€ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— promisifyë¡œ callbackí•¨ìˆ˜ë¥¼ í•œ ë²ˆ ê°ì‹¸ì„œ ì‚¬ìš©í•œë‹¤.
        - promisifyë¥¼ í™œìš©í•˜ë©´ then, catchë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ. (awaitë„ ì‚¬ìš© ê°€ëŠ¥)
        - ë‹¨, callbackí•¨ìˆ˜ëŠ” (error, data) â‡’ {}
        
        ```jsx
        const randomBytesPromise = util.promisify(crypto.randombytes);
        randomBytesPromise(64)
        	.then(...)
        	.catch(...)
        ```
        

## worker_threads

- ë…¸ë“œì—ì„œ ë©€í‹°ìŠ¤ë ˆë“œ ë°©ì‹ìœ¼ë¡œ ì‘ì—…í•  ìˆ˜ ìˆë‹¤
- ì›Œì»¤ ìŠ¤ë ˆë“œë¥¼ í™œìš©í•˜ëŠ” ë°©ë²•
    1. ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì›Œì»¤ ìŠ¤ë ˆë“œ ìƒì„± í›„ ì‘ì—…  ë¶„ë°°
    2. ì›Œì»¤ ìŠ¤ë ˆë“œì—ì„œ ì‘ì—… ì‹œì‘
    3. ì›Œì»¤ ìŠ¤ë ˆë“œì—ì„œ ì‘ì—…ì„ ë§ˆì¹˜ë©´ ë©”ì¸ ìŠ¤ë ˆë“œë¡œ ì „ë‹¬
    4. ë©”ì¸ ìŠ¤ë ˆë“œì—ì„œ ì›Œì»¤ ìŠ¤ë ˆë“œë“¤ì˜ ì‘ì—…ì„ í•©ì³ ìµœì¢…ì ì¸ ê²°ê³¼ë¬¼ ì „ë‹¬
- 1ê°œì˜ ì›Œì»¤ ìŠ¤ë ˆë“œ í™œìš© ì˜ˆì‹œ
    
    ```jsx
    const { Worker, isMainThread, parentPort } = require("worker_threads");
    
    if (isMainThread) {
      // ë©”ì¸ ìŠ¤ë ˆë“œ
      const worker = new Worker(__filename);
    
      worker.on("message", (value) => {
        console.log("ì›Œì»¤ë¡œë¶€í„° ", value);
      });
      worker.on("exit", () => {
        console.log("ì›Œì»¤ ë");
      });
    
      worker.postMessage("ping");
    } else {
      // ì›Œì»¤ ìŠ¤ë ˆë“œ
      parentPort.on("message", (value) => {
        console.log("ë¶€ëª¨ë¡œë¶€í„° ", value);
        parentPort.postMessage("pong");
        parentPort.close();
      });
    }
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 1.11.36.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.11.36.png)
    
- 2ê°œì˜ ì›Œì»¤ ìŠ¤ë ˆë“œ í™œìš© ì˜ˆì‹œ
    
    ```jsx
    const {
      Worker,
      isMainThread,
      parentPort,
      workerData,
    } = require("worker_threads");
    
    if (isMainThread) {
      // ë©”ì¸ ìŠ¤ë ˆë“œ
      const threads = new Set();
      threads.add(
        new Worker(__filename, {
          workerData: { start: 1 },
        })
      );
      threads.add(
        new Worker(__filename, {
          workerData: { start: 2 },
        })
      );
      for (let worker of threads) {
        worker.on("message", (value) => {
          console.log("ì›Œì»¤ë¡œë¶€í„° ", value);
        });
        worker.on("exit", () => {
          threads.delete(worker);
          if (threads.size === 0) {
            console.log("ì›Œì»¤ ë");
          }
        });
      }
    } else {
      // ì›Œì»¤ ìŠ¤ë ˆë“œ
      const data = workerData;
      parentPort.postMessage(data.start + 100);
    }
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 1.18.52.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.18.52.png)
    
- ì›Œì»¤ ìŠ¤ë ˆë“œë¥¼ í™œìš©í•˜ì—¬ ì†Œìˆ˜ êµ¬í•˜ê¸°
    
    ```jsx
    const {
      Worker,
      isMainThread,
      parentPort,
      workerData,
    } = require("worker_threads");
    
    const min = 2;
    let primes = [];
    
    function findPrimes(start, range) {
      let isPrime = true;
      const end = start + range;
    
      for (let i = start; i < end; i++) {
        for (let j = min; j < Math.sqrt(end); j++) {
          if (i !== j && i % j === 0) {
            isPrime = false;
            break;
          }
        }
        if (isPrime) {
          primes.push(i);
        }
        isPrime = true;
      }
    }
    
    if (isMainThread) {
      const max = 10_000_000;
      const threadCount = 8;
      const threads = new Set();
    
      const range = Math.ceil((max - min) / threadCount);
      let start = min;
      console.time("prime");
      for (let i = 0; i < threadCount - 1; i++) {
        const wStart = start;
        threads.add(
          new Worker(__filename, { workerData: { start: wStart, range } })
        );
        start += range;
      }
      threads.add(
        new Worker(__filename, {
          workerData: { start, range: range + ((max - min + 1) % threadCount) },
        })
      );
    
      for (let worker of threads) {
        // workerì—ì„œ ì—ëŸ¬ê°€ ë‚¬ì„ ê²½ìš°
        worker.on("error", (err) => {
          throw err(err);
        });
    
        worker.on("exit", () => {
          threads.delete(worker);
          if (threads.size === 0) {
            console.timeEnd("prime");
            console.log(primes.length);
          }
        });
    
        // workerë“¤ì˜ ì¼ì„ í•©ì³ì¤€ë‹¤.
        worker.on("message", (msg) => {
          primes = primes.concat(msg);
        });
      }
    } else {
      findPrimes(workerData.start, workerData.range);
      parentPort.postMessage(primes);
    }
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 1.35.31.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_1.35.31.png)
    
- ì›Œì»¤ ìŠ¤ë ˆë“œë¥¼ ë§ì´ ë§Œë“ ë‹¤ê³  ë¹„ë¡€í•´ì„œ ì‹œê°„ì´ ì¤„ì–´ë“œëŠ” ê²ƒì€ ì•„ë‹ˆë‹¤!
    - ì›Œì»¤ ìŠ¤ë ˆë“œ ìƒì„± ì‹œì—ë„ ì‹œê°„ì´ ê±¸ë¦°ë‹¤
    - ë©”ì¸ ìŠ¤ë ˆë“œ â†’ ì›Œì»¤ ìŠ¤ë ˆë“œë¡œ ë¶„ë°°í•˜ëŠ” ì‹œê°„ë„ ê±¸ë¦°ë‹¤
    - ì»´í“¨í„° ì‚¬ì–‘ì— ë”°ë¼ì„œë„ ë‹¬ë¼ì§„ë‹¤

<aside>
ğŸ’¡ êµ³ì´ Nodeë¡œëŠ” ë©€í‹°ìŠ¤ë ˆë“œë¥¼ ìƒì„±í•˜ì—¬ ì‘ì—…í•˜ì§€ ì•ŠëŠ” ê²ƒì„ ì¶”ì²œ!

</aside>

## child_process

```jsx
const exec = require("child_process").exec;

var process = exec("dir");

// ì½˜ì†” ì°½ì—ì„œ dir ì‹œ ì¶œë ¥ë˜ëŠ” ê²°ê³¼ ë°ì´í„°
process.stdout.on("data", function (data) {
  console.log(data.toSting());
});

// ì½˜ì†” ì°½ì—ì„œ dir í›„ ì—ëŸ¬ë°œìƒ ì‹œ ê²°ê³¼ ë°ì´í„°
process.stderr.on("data", function (data) {
  console.error(data.toSting());
});
```

- ë©€í‹° ìŠ¤ë ˆë“œëŠ” ë‹¤ë¥¸ ì–¸ì–´ë¡œ ì§œëŠ” ê²ƒì´ ì¢‹ê¸° ë•Œë¬¸ì— child_processë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤.
    
    ```jsx
    const spawn = require("child_process".spawn);
    
    // test.py íŒŒì¼ì„ nodeë¥¼ í†µí•´ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤(but, pythonì´ ì»´í“¨í„°ì— ê¹”ë ¤ìˆì–´ì•¼ í•¨)
    const process = spawn("python", ["test.py"]);
    ```
    

## íŒŒì¼ ì‹œìŠ¤í…œ(fs)

- fs : íŒŒì¼ ì‹œìŠ¤í…œì— ì ‘ê·¼í•˜ëŠ” ëª¨ë“ˆ
    - íŒŒì¼ or í´ë” `ìƒì„±/ì‚­ì œ/ì½ê¸°/ì“°ê¸°` ê°€ëŠ¥
    - ì›¹ ë¸Œë¼ìš°ì €ì—ì„œëŠ” ì œí•œì ì´ë‚˜ nodeì—ì„œëŠ” ê¶Œí•œì´ ìˆìŒ
- íŒŒì¼ ì½ê¸°
    
    ```jsx
    const fs = require("fs");
    
    fs.readFile("./readme.txt", (err, data) => {
      if (err) {
        throw err;
      }
      console.log(data); // 16ì§„ìˆ˜ ë°ì´í„°
      console.log(data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
    });
    ```
    
    ```jsx
    // promiseë¡œ fs í™œìš©í•˜ê¸°
    const fs = require("fs").promises;
    
    fs.readFile("./readme.txt")
      .then((data) => {
        console.log(data); // 16ì§„ìˆ˜ ë°ì´í„°
        console.log(data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
      })
      .catch((err) => {
        throw err;
      });
    ```
    
- íŒŒì¼ ì“°ê¸°
    
    ```jsx
    const fs = require("fs").promises;
    
    fs.writeFile("./writeme.txt", "ê¸€ì„ ì¨ì£¼sayYo")
      .then(() => {
        return fs.readFile("./writeme.txt");
      })
      .then((data) => {
        console.log(data);
        console.log(data.toString());
      })
      .catch((err) => {});
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 2.23.50.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.23.50.png)
    
- ë¹„ë™ê¸°ì ìœ¼ë¡œ íŒŒì¼ ì½ê¸°
    
    ```jsx
    const fs = require("fs");
    
    fs.readFile("./readme.txt", (err, data) => {
      if (err) {
        throw err;
      }
      console.log("1ë²ˆ", data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
    });
    
    fs.readFile("./readme.txt", (err, data) => {
      if (err) {
        throw err;
      }
      console.log("2ë²ˆ", data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
    });
    
    fs.readFile("./readme.txt", (err, data) => {
      if (err) {
        throw err;
      }
      console.log("3ë²ˆ", data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
    });
    
    fs.readFile("./readme.txt", (err, data) => {
      if (err) {
        throw err;
      }
      console.log("4ë²ˆ", data.toString()); // ì‚¬ëŒì´ ì½ì„ ìˆ˜ ìˆëŠ” ë°ì´í„°
    });
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 2.32.41.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.32.41.png)
    
- ë™ê¸°ì ìœ¼ë¡œ íŒŒì¼ ì½ê¸°
    - ë§¤ìš° ë¹„íš¨ìœ¨ì 
    - ë”± í•œ ë²ˆ ì‘ì—…í•˜ê±°ë‚˜ ì„œë²„ ì´ˆê¸°í™”í•  ë•Œë§Œ ì‚¬ìš©í•´ì•¼í•œë‹¤. ì„œë²„ ì‚¬ìš© ì¤‘ì— í˜¸ì¶œë  ê²½ìš° ë§ˆì§€ë§‰ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì‚¬ëŒì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆë‹¤.
        
        ```jsx
        const fs = require("fs");
        
        let data = fs.readFileSync("./readme.txt");
        console.log("1ë²ˆ", data.toString());
        data = fs.readFileSync("./readme.txt");
        console.log("2ë²ˆ", data.toString());
        data = fs.readFileSync("./readme.txt");
        console.log("3ë²ˆ", data.toString());
        data = fs.readFileSync("./readme.txt");
        console.log("4ë²ˆ", data.toString());
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 2.35.12.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.35.12.png)
        
- ë¹„ë™ê¸°ë¡œ ìˆœì„œ ì§€ì¼œì„œ íŒŒì¼ ì½ê¸°
    - ë™ì‹œì„±ë„ ì‚´ë¦¬ê³  ìˆœì„œë„ ì§€í‚¬ ìˆ˜ ìˆìŒ!
        
        ```
        const fs = require("fs").promises;
        
        async function main() {
          let data = await fs.readFile("./readme.txt");
          console.log("1ë²ˆ", data.toString());
          data = await fs.readFile("./readme.txt");
          console.log("1ë²ˆ", data.toString());
          data = await fs.readFile("./readme.txt");
          console.log("1ë²ˆ", data.toString());
          data = await fs.readFile("./readme.txt");
          console.log("1ë²ˆ", data.toString());
        }
        
        main();
        ```
        

## Buffer / Stream

- `Buffer` : ì¼ì •í•œ í¬ê¸°ë¡œ ëª¨ì•„ë‘ëŠ” ë°ì´í„°
    - ex) 100mb íŒŒì¼ì„ ì„œë²„ì—ì„œ 100mbê°€ ë‹¤ ì°° ë•Œê¹Œì§€ ê¸°ë‹¤ë¦° í›„ ì „ë‹¬
- `Stream` : ë°ì´í„°ì˜ íë¦„
    - ex) 100mb íŒŒì¼ì„ 1mbì”© ì „ë‹¬í•œë‹¤
    - ëŒ€ìš©ëŸ‰ íŒŒì¼ì„ ë³´ë‚´ë ¤ë©´ ìŠ¤íŠ¸ë¦¬ë° í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
    - ë©”ëª¨ë¦¬ ê´€ë¦¬ê°€ íš¨ìœ¨ì ì´ë‹¤.

![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 2.48.53.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_2.48.53.png)

### Buffer

- íŒŒì¼ì„ bufferë¥¼ í†µí•´ ì½ê¸° ìœ„í•´ì„œëŠ” fs.readFile()ì„ í™œìš©í•  ìˆ˜ ìˆë‹¤.

### Stream

- readStream
    
    ```jsx
    const fs = require("fs");
    const readStream = fs.createReadStream("./readme-buffer.txt");
    
    const data = [];
    readStream.on("data", (chunk) => {
      data.push(chunk);
    
      console.log("data : ", chunk, chunk.length);
    });
    readStream.on("end", () => {
      console.log("end : ", Buffer.concat(data).toString());
    });
    readStream.on("error", () => {
      console.log("error : ", err);
    });
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 3.01.32.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.01.32.png)
    
    - ìœ„ì™€ ê°™ì´ ê²°ê³¼ê°€ ë‚˜ì˜¨ ì´ìœ ëŠ”, í•œ ë²ˆì— ì½ëŠ” ì¡°ê°ì´ 64kbì´ë‹¤ë³´ë‹ˆ ì‘ì€ íŒŒì¼ì€ í•œ ë²ˆì— ì½ê³  ê°€ì ¸ì˜¤ê¸° ë•Œë¬¸ì— ë§ˆì¹˜ bufferì™€ ê°™ì´ í•œêº¼ë²ˆì— ê°€ì ¸ì˜¨ ê²ƒ ê°™ì•„ ë³´ì¸ë‹¤.
    - `highWaterMark`ë¥¼ í™œìš©í•˜ì—¬ ì½ëŠ” ì¡°ê°ì˜ í¬ê¸°ë¥¼ ë³€ê²½í•˜ë©´ streamì´ ì½ì–´ë“¤ì´ëŠ” ë°©ì‹ì„ í™•ì¸í•  ìˆ˜ ìˆìŒ!
        
        ```jsx
        const readStream = fs.createReadStream("./readme-buffer.txt", {
          highWaterMark: 16,       // 16 byte
        });
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 3.02.47.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.02.47.png)
        
- writeStream
    - writeStream ì´ë²¤íŠ¸ : write, end, finish(ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ)
        
        ```jsx
        const fs = require("fs");
        
        const writeStream = fs.createWriteStream("./writeme2.txt");
        // writeStream ì´ë²¤íŠ¸ -> write, end, finish(ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ)
        writeStream.on("finish", () => {
          console.log("íŒŒì¼ ì“°ê¸° ì™„ë£Œ");
        });
        
        // write()í•œê°œê°€ í•˜ë‚˜ì˜ ë²„í¼
        writeStream.write("ì´ ê¸€ì„ ì”ë‹ˆë‹¤.\n");
        writeStream.write("í•œ ë²ˆ ë” ì”ë‹ˆë‹¤.");
        writeStream.end();
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 4.08.54.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.08.54.png)
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 4.09.06.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.09.06.png)
        

## pipeì™€ ìŠ¤íŠ¸ë¦¼ ë©”ëª¨ë¦¬ íš¨ìœ¨ í™•ì¸

### pipe

```jsx
const fs = require("fs");

const readStream = fs.createReadStream("./readme-buffer.txt", {
  highWaterMark: 16,
});
const writeStream = fs.createWriteStream("./write-buffer.txt");
readStream.pipe(writeStream);
```

- zlibë¥¼ í†µí•´ ì••ì¶•ëœ íŒŒì¼ë„ ì €ì¥í•  ìˆ˜ ìˆë‹¤
    
    ```jsx
    const fs = require("fs");
    const zlib = require("zlib");
    
    const readStream = fs.createReadStream("./readme-buffer.txt", {
      highWaterMark: 16,
    });
    // ì••ì¶• ìŠ¤íŠ¸ë¦¼
    const zlibStream = zlib.createGzip();
    
    // ì••ì¶•ëœ ê±¸ ì €ì¥í•œë‹¤
    const writeStream = fs.createWriteStream("./write-buffer.txt.gz");
    readStream.pipe(zlibStream).pipe(writeStream);
    ```
    
    - streamingì„ í•˜ë©´ ë‹¤ì–‘í•œ pipeë¼ë¦¬ ì—°ê²°í•  ìˆ˜ ìˆë‹¤. â†’ streamì—ì„œë§Œ pipeë¼ë¦¬ì˜ ì—°ê²° ì§€ì›

### stream ë©”ëª¨ë¦¬ íš¨ìœ¨ í™•ì¸í•˜ê¸°

- streamì„ í™œìš©í–ˆì„ ë•Œ í›¨ì‹  íš¨ìœ¨ì´ ì¢‹ì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ
- ex) 1GBì˜ big.txt íŒŒì¼ ì½ê³  ì“°ê¸°
    - buffer
        
        ```jsx
        // buffer-memory.ts
        
        const fs = require("fs");
        
        console.log("before: ", process.memoryUsage().rss);
        
        const data = fs.readFileSync("./big.txt");
        fs.writeFileSync("./big2.txt", data);
        console.log("buffer: ", process.memoryUsage().rss);
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 6.14.40.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.14.40.png)
        
    - stream
        
        ```jsx
        // stream-memory.ts
        
        const fs = require("fs");
        
        console.log("before: ", process.memoryUsage().rss);
        
        const readStream = fs.createReadStream("./big.txt");
        const writeStream = fs.createWriteStream("./big3.txt");
        readStream.pipe(writeStream);
        readStream.on("end", () => {
          console.log("buffer : ", process.memoryUsage().rss);
        });
        ```
        
        ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 6.15.15.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.15.15.png)
        

### ê¸°íƒ€ fs ë©”ì†Œë“œ

- fileSystem ê³µì‹ ë¬¸ì„œ : [https://nodejs.org/dist/latest-v20.x/docs/api/fs.html](https://nodejs.org/dist/latest-v20.x/docs/api/fs.html)

```jsx
fs.access(ê²½ë¡œ, ì˜µì…˜, ì½œë°±);  // í´ë”ë‚˜ íŒŒì¼ ì ‘ê·¼ ê°€ëŠ¥ ì—¬ë¶€ í™•ì¸
fs.mkdir(ê²½ë¡œ, ì½œë°±);        // í´ë” ë§Œë“¤ê¸°
fs.open(ê²½ë¡œ, ì˜µì…˜, ì½œë°±);    // íŒŒì¼ ì•„ì´ë”” ê°€ì ¸ì˜¤ê¸°(íŒŒì¼ì´ ì—†ìœ¼ë©´ ìƒˆë¡œ ìƒì„±)
fs.rename(ê¸°ì¡´ê²½ë¡œ, ìƒˆ ê²½ë¡œ, ì½œë°±);  // íŒŒì¼ëª… ë³€ê²½í•˜ê¸°
fs.readdir(ê²½ë¡œ, ì½œë°±);      // í´ë” ì•ˆ ë‚´ìš© í™•ì¸(ë°°ì—´ ì•ˆì— ë‚´ë¶€ íŒŒì¼ ë° í´ë”ëª…ì´ ë‚˜ì˜¨ë‹¤)
fs.unlink(ê²½ë¡œ, ì½œë°±);       // íŒŒì¼ ì‚­ì œ
fs.rmdir(ê²½ë¡œ, ì½œë°±);        // í´ë” ì‚­ì œ
fs.copyFile(ê¸°ì¡´ê²½ë¡œ, ìƒˆ ê²½ë¡œ);   // íŒŒì¼ ë³µì‚¬
fs.watch(ê²½ë¡œ, ì½œë°±);           // íŒŒì¼ ê°ì‹œ(ë³€ê²½ì‚¬í•­ ë°œìƒ ì‹œ ì´ë²¤íŠ¸ í˜¸ì¶œ)
fs.existsSync();           // íŒŒì¼ì´ë‚˜ í´ë”ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
fs.stat();                 // íŒŒì¼ì¸ì§€ í´ë”ì¸ì§€ ë°”ë¡œê°€ê¸°ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ
```

## ìŠ¤ë ˆë“œí’€ê³¼ ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸

### ìŠ¤ë ˆë“œí’€

- fs, crypto, zlib ëª¨ë“ˆì˜ ë©”ì†Œë“œ ì‹¤í–‰ ì‹œ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë™ì‹œì— ì‹¤í–‰ëœë‹¤(ìŠ¤ë ˆë“œí’€ì´ ë™ì‹œì— ì²˜ë¦¬)
- cryptoê°™ì€ ê²½ìš° 4ê°œì”© ê·¸ë£¹ì§€ì–´ ìˆ˜í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ
    - UV_THREADPOOL_SIZE = 8 ë¡œ ë°”ê¾¸ë©´ 8ê°œì˜ ì½”ì–´ë¥¼ í™œìš©í•œë‹¤
    â‡’ 8ê°œ ì „ì²´ê°€ ê·¸ë£¹ì§€ì–´ ìˆ˜í–‰ëœë‹¤.
    - ìê¸° ì»´í“¨í„° ì‚¬ì–‘ì— ë§ê²Œ ì ì ˆí•˜ê²Œ ì¡°ì ˆí•˜ë©´ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
    
    ```jsx
    const crypto = require("crypto");
    
    const pass = "pass";
    const salt = "salt";
    const start = Date.now();
    
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("1", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("2", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("3", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("4", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("5", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("6", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("7", Date.now() - start);
    });
    crypto.pbkdf2(pass, salt, 1_000_000, 128, "sha512", () => {
      console.log("8", Date.now() - start);
    });
    ```
    
    ![á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-07-30 á„‹á…©á„’á…® 6.36.57.png](%E1%84%89%E1%85%A6%E1%86%A8%E1%84%89%E1%85%A7%E1%86%AB2%20%E1%84%82%E1%85%A9%E1%84%83%E1%85%B3%20%E1%84%80%E1%85%B5%E1%84%87%E1%85%A9%E1%86%AB%20%E1%84%80%E1%85%B5%E1%84%82%E1%85%B3%E1%86%BC%20%E1%84%8B%E1%85%B5%E1%86%A8%E1%84%92%E1%85%B5%E1%84%80%E1%85%B5%20fab16763337e4ee0b0543ff240c40f77/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2023-07-30_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_6.36.57.png)
    

### ì»¤ìŠ¤í…€ ì´ë²¤íŠ¸

- ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•˜ì—¬ ì´ë²¤íŠ¸ ì‹¤í–‰ ì‹œ íŠ¹ì • ë™ì‘ ê³µìœ  ê°€ëŠ¥

```jsx
const EventEmitter = require("events");

const myEvent = new EventEmitter();

// ì´ë²¤íŠ¸ ë“±ë¡
myEvent.addListener("event1", () => {
  console.log("event1");
});
myEvent.on("event2", () => {
  console.log("event2");
});
myEvent.on("event2", () => {
  console.log("event2 added");
});

// í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸
myEvent.once("event3", () => {
  console.log("event3");
});

myEvent.emit("event1");
myEvent.emit("event2");
myEvent.emit("event3");
// event3ì€ í•œ ë²ˆë§Œ ì‹¤í–‰ë˜ëŠ” ì´ë²¤íŠ¸ ì´ë¯€ë¡œ ì‹¤í–‰ ì•ˆëŒ
myEvent.emit("event3");
```

```jsx
// ì—°ê²°ëœ ëª¨ë“  ì´ë²¤íŠ¸ ì‚­ì œ
myEvent.on("event4", () => {
  console.log("event4");
});
myEvent.removeAllListeners("event4");
```

```jsx
// í•œ ê°œì˜ ì´ë²¤íŠ¸ë§Œ ì‚­ì œ
const listener = () => {
  console.log("event5");
};

myEvent.on("event5", listener);

// ì‚­ì œí•˜ê¸° ìœ„í•´ì„œëŠ” callback í•¨ìˆ˜ë¥¼ ë„˜ê²¨ì¤˜ì•¼ í•¨
myEvent.removeListener("event5", listener);

// ì—°ê²°ëœ ì´ë²¤íŠ¸ ê°œìˆ˜
console.log(myEvent.listenerCount("event2"));
```

## ì˜ˆì™¸ ì²˜ë¦¬

- ì˜ˆì™¸(Exception) : ì²˜ë¦¬í•˜ì§€ ëª»í•œ ì—ëŸ¬
    - ë…¸ë“œ ìŠ¤ë ˆë“œ ë©ˆì¶¤
- ì˜ˆì™¸ ì²˜ë¦¬ (â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸)
    - `try/catch ë¬¸`ìœ¼ë¡œ ì˜ˆì™¸ ì²˜ë¦¬
    - ì½œë°± í•¨ìˆ˜ì—ì„œ `ì—ëŸ¬ ê°ì²´ ì œê³µ`
        
        ```jsx
        (err, data) => {
        	if(err) {
        		console.error(err)
        	}
        }
        ```
        
    - promiseë¥¼ ì‚¬ìš©í•  ë•ŒëŠ” ë°˜ë“œì‹œ `catchë¥¼ ì‚¬ìš©`í•œë‹¤
- ëª¨ë“  ì½”ë“œë¥¼ try/catch í•˜ê¸° ì–´ë µë‹¤ë©´, ìµœí›„ì˜ ìˆ˜ë‹¨ìœ¼ë¡œ process.on() ì‚¬ìš©
    - ì½œë°± í•¨ìˆ˜ì˜ ë™ì‘ì´ ë³´ì¥ë˜ì§€ ì•Šê¸° ë•Œë¬¸ì— process.on() ì•ˆì—ëŠ” ì—ëŸ¬ ë³µêµ¬ ì½”ë“œë¥¼ ì ìœ¼ë©´ ì•ˆëœë‹¤.
    - ì—ëŸ¬ ê¸°ë¡ìš©ìœ¼ë¡œë§Œ ì‚¬ìš©í•  ê²ƒ!
    
    <aside>
    ğŸ’¡ but, ì—ëŸ¬ê°€ ìˆëŠ” ì½”ë“œëŠ” ì˜³ì§€ ëª»í•œ ì½”ë“œì´ë¯€ë¡œ ë°˜ë“œì‹œ ê³ ì³ì•¼í•œë‹¤!
    
    </aside>
    
    ```jsx
    process.on('uncaughtException', (err) => {
    	console.error('ì˜ˆê¸°ì¹˜ ëª»í•œ ì—ëŸ¬', err);
    });
    ```
    
- í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œí•˜ê¸°
    
    ```jsx
    // í¬íŠ¸ ë„˜ë²„ í™•ì¸í•˜ê¸°
    lsof -i tcl:í¬íŠ¸
    // í˜¹ì€ node ë‚´ì—ì„œ
    process.pid
    
    // í”„ë¡œì„¸ìŠ¤ ì¢…ë£Œí•˜ê¸°
    kill -9 í”„ë¡œì„¸ìŠ¤ì•„ì´ë””
    ```